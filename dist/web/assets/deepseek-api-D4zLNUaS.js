var S=Object.defineProperty;var l=(t,e,r)=>e in t?S(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r;var u=(t,e,r)=>l(t,typeof e!="symbol"?e+"":e,r);import{r as E,A as i,e as c}from"./index-DarROT6V.js";class y{constructor(e){u(this,"apiKey");this.apiKey=e}async generateChat(e,r="deepseek-chat",p=4e3){const s=await E(`${i.DEEPSEEK_BASE_URL}/chat/completions`,{method:"POST",headers:{Authorization:`Bearer ${this.apiKey}`,"Content-Type":"application/json"},body:JSON.stringify({model:r,messages:e,max_tokens:p,temperature:.7}),timeout:i.REQUEST_TIMEOUT});if(!s.ok)throw c.createApiError(s.status,s.statusText,"DeepSeek API");const o=await s.json();if(!o.choices||o.choices.length===0)throw c.createResponseError("空的响应","DeepSeek API");return o.choices[0].message.content}async generateWeeklyReport(e,r,p="deepseek-chat",s=4e3){var h;const o=[{role:"system",content:r},{role:"user",content:`以下是GitLab事件数据：

${e}

请根据这些数据生成工作周报。`}],a=await E(`${i.DEEPSEEK_BASE_URL}/chat/completions`,{method:"POST",headers:{Authorization:`Bearer ${this.apiKey}`,"Content-Type":"application/json"},body:JSON.stringify({model:p,messages:o,max_tokens:s,temperature:.7}),timeout:i.REQUEST_TIMEOUT});if(!a.ok)throw c.createApiError(a.status,a.statusText,"DeepSeek API");const n=await a.json();if(!n.choices||n.choices.length===0)throw c.createResponseError("空的响应","DeepSeek API");return{content:n.choices[0].message.content,tokensUsed:((h=n.usage)==null?void 0:h.total_tokens)||0}}async validateApiKey(){try{return await this.generateChat([{role:"user",content:"Hello"}],"deepseek-chat",10),!0}catch{return!1}}}function A(t){return new y(t)}export{y as DeepSeekApiService,A as createDeepSeekApiService};
